<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>PlantÃ£o do mÃªs atual</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }

    .top-bar {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
    }

    .btn-alterar,
    .btn-pdf {
      padding: 6px 12px;
      font-size: 14px;
      cursor: pointer;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 8px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
    }

    .passado {
      background-color: #eee;
    }

    .hoje {
      background-color: #ffeeba;
    }
  </style>
</head>
<body>
    
    <h1>PlantÃ£o do MÃªs Atual</h1>
    
  <div class="top-bar">
    <button class="btn-alterar" onclick="abrirModalDataInicial()">Alterar Data Inicial</button>
    <button class="btn-pdf" onclick="printSection('muralPlantao')">ðŸ“„ PDF</button>
  </div>

  <div class="mural" id="muralPlantao"></div>

  <!-- Modal de Data Inicial -->
  <div class="modal" id="modalDataInicial">
    <div class="modal-content">
      <h3>Definir Nova Data Inicial</h3>
      <input type="date" id="novaDataInicial" />
      <button onclick="salvarDataInicial()">Salvar Data</button>
    </div>
  </div>

  <script>
    const sequenciaEquipes = [
      "Silvano, Anderson",
      "Silvano, Anderson",
      "Silvano, Anderson",
      "Bruno, JosuÃ©",
      "Sadrack, Elison, Talisom",
      "Silvano, Anderson",
      "Bruno, JosuÃ©",
      "Sadrack, Elison, Talisom",
      "Sadrack, Elison, Talisom",
      "Sadrack, Elison, Talisom",
      "Silvano, Anderson",
      "Bruno, JosuÃ©",
      "Sadrack, Elison, Talisom",
      "Silvano, Anderson",
      "Bruno, JosuÃ©",
      "Bruno, JosuÃ©",
      "Bruno, JosuÃ©",
      "Sadrack, Elison, Talisom",
      "Silvano, Anderson",
      "Bruno, JosuÃ©",
      "Sadrack, Elison, Talisom"
    ];

    let dataInicialPlantao = new Date(new Date().getFullYear(), 0, 1); // 1Âº de janeiro do ano atual

    function gerarTabelaPlantao(mes = null, ano = null) {
      const mural = document.getElementById("muralPlantao");
      mural.innerHTML = "";

      const hoje = new Date();
      const mesSelecionado = mes !== null ? mes : hoje.getMonth();
      const anoSelecionado = ano !== null ? ano : hoje.getFullYear();
      const diaHoje = hoje.getDate();
      const diasNoMes = new Date(anoSelecionado, mesSelecionado + 1, 0).getDate();

      const titulo = document.createElement("h3");
      titulo.textContent = `MÃªs: ${(mesSelecionado + 1).toString().padStart(2, '0')}/${anoSelecionado}`;
      const tabela = document.createElement("table");
      tabela.innerHTML = "<thead><tr><th>Dia</th><th>Semana</th><th>Equipe</th></tr></thead><tbody></tbody>";
      const tbody = tabela.querySelector("tbody");

      for (let dia = 1; dia <= diasNoMes; dia++) {
        const data = new Date(anoSelecionado, mesSelecionado, dia);
        const diaSemana = data.getDay();
        const nomeSemana = data.toLocaleDateString("pt-BR", { weekday: "long" });

        const diffDias = Math.floor((data - dataInicialPlantao) / (1000 * 60 * 60 * 24));
        const indexEquipe = diffDias % sequenciaEquipes.length;

        const linha = tbody.insertRow();
        if (anoSelecionado === hoje.getFullYear() && mesSelecionado === hoje.getMonth()) {
          if (dia < diaHoje) linha.classList.add("passado");
          else if (dia === diaHoje) linha.classList.add("hoje");
        }

        linha.insertCell().textContent = dia;
        linha.insertCell().textContent = nomeSemana;
        linha.insertCell().textContent = sequenciaEquipes[indexEquipe];
      }

      mural.appendChild(titulo);
      mural.appendChild(tabela);
    }

    function abrirModalDataInicial() {
      document.getElementById("modalDataInicial").style.display = "flex";
      document.getElementById("novaDataInicial").value = dataInicialPlantao.toISOString().split("T")[0];
    }

    function salvarDataInicial() {
      const input = document.getElementById("novaDataInicial").value;
      if (input) {
        dataInicialPlantao = new Date(input);
        document.getElementById("modalDataInicial").style.display = "none";
        gerarTabelaPlantao();
      }
    }

    function printSection(id) {
      const original = document.body.innerHTML;
      const content = document.getElementById(id).innerHTML;
      document.body.innerHTML = content;
      window.print();
      document.body.innerHTML = original;
      gerarTabelaPlantao();
    }

    gerarTabelaPlantao();
  </script>
</body>
</html>